---
group:
  title: 基础篇
  order: 3
---

# 样式计算

## 不同`CSS`作用方式的优先级别

在平时开发中，经常会发生 `样式覆盖` 的问题（即，不同选择器为同一个节点设置样式）。原因在于一个节点的样式会受很多因素的影响，在 `CSS` 中会根据相关规范分配给规则一个权重，根据样式可以计算 `CSS` 权重，权重计算结果最高的样式决定最终页面的呈现效果。

在 `HTML` 中有四种设置 `CSS` 设置的方式，分别是：`内联样式`、`内嵌样式`、`外部样式`、`导入样式`

1. 内联样式：

```html
<p style={"color: #f66"}></p>
```

2. 内嵌样式：

```html
<head>
  <style>
    p {
      color: #f66;
    }
  </style>
</head>
```

3. 外部样式：

```html
<head>
  <link rel="stylesheet" href="./main.css" />
</head>
```

4. 导入样式

```html
<head>
  <style>
    @import url('./common.css');
  </style>
</head>
```

那以上四种方式，谁的优先级更高呢？

直接给出结论：`内联样式` => `内嵌样式` => `外部样式` => `导入样式`

通过上面的文字不是很好记忆，其实记住就近原则 + 浏览器的渲染机制，就可以自己推导出以上结论。

`内联样式` 直接作用在节点中，因此优先级别最高。`内嵌样式`附属于`html文件`的解析而解析，因此优先级别跟着`内联样式`。`外部样式`需加载完毕才能解析，因此优先级别跟着`内嵌样式`。`导入样式`作用于`内联样式`或`外部样式`中，因此优先级别跟着`外部样式`。

## CSS 选择器权重

上述都是基于文件层面的理解，那进入文件中所有样式都使用不同选择器声明，那如何区它们的分优先级别？选择器有着明显不可逾越的等级制度，可将其划分为六个权重等级。每个等级间的优先级别差距不可逾越，这些等级又称为权重。

以下从`直观权重`与`微观权重`两方面表述。简而言之，数字组成的值越大其权重就越大。

> 直观权重

- **10000**：`!important`
- **1000**：`内联样式`
- **100**：`ID选择器`
- **10**：`类选择器`、`伪类选择器`、`属性选择器`
- **1**：`标签选择器`、`伪元素选择器`
- **0**：`通配选择器`、`兄弟选择器`、`后代选择器`

> 微观权重

- **1,0,0,0,0**：`!important`
- **0,1,0,0,0**：`内联样式`
- **0,0,1,0,0**：`ID选择器`
- **0,0,0,1,0**：`类选择器`、`伪类选择器`、`属性选择器`
- **0,0,0,0,1**：`标签选择器`、`伪元素选择器`
- **0,0,0,0,0**：`通配选择器`、`兄弟选择器`、`后代选择器`

总体来说直观权重与微观权重只是表达方式不同，但实际意义一样，使用公式可表达为以下形式。

```
!important > 内联样式 > ID选择器 > 类选择器 = 伪类选择器 = 属性选择器 > 标签选择器 = 伪元素选择器 > 通配选择器 = 兄弟选择器 = 后代选择器
```

## CSS 单位

理论需要知道：设备像素、设备独立像素、`DPR`

不考虑低版本浏览器的兼容，移动端的伸缩方案：

公式换算：

$$
\frac{x}{750} \times 100 \ vw  = \frac{x}{100} \times \frac{100vw}{7.5} = \frac{x}{100} \times 1rem
$$

其中，`x`是元素尺寸，`x/750` 含义是元素占总 `UI` 图纸的宽度的百分比。

```css
/* 
UI 给的图一般是基于 iphone6 的两倍图
即 375 * 667 (750 * 1334)
*/
html {
  font-size: calc(100vw / 7.5); /*   */
}
```

如果按照上述公式进行公式转换后，在设计尺寸上的 `100px` 应换算为 `1rem`。
